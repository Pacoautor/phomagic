{% extends "base.html" %}
{% block content %}
<h2>2) Subir imagen</h2>

<p><strong>Selección:</strong> {{ selection }}</p>

{% if error %}
  <div style="color: red;">{{ error }}</div>
{% endif %}

{% if assets %}
  <h3>Selecciona una vista:</h3>
  <div style="display:flex; flex-wrap:wrap; gap:20px;">
    {% for asset in assets %}
      <div style="text-align:center;">
        <img src="{{ asset.thumb_url }}" width="200" style="border:1px solid #ccc; border-radius:8px; margin-bottom:10px;">
        <form method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <input type="hidden" name="asset_id" value="{{ asset.id }}">
          <label>Selecciona archivo</label><br>
          <input type="file" name="image" accept="image/*" required><br><br>
          <button type="submit">Procesar esta vista</button>
        </form>
      </div>
    {% endfor %}
  </div>
{% else %}
  <p>No se encontraron miniaturas para esta selección. Añádelas en <code>products/lineas/&lt;Categoría&gt;_&lt;Subcategoría&gt;/</code> con un .docx de prompt.</p>
{% endif %}

<p><a href="{% url 'select_category' %}">Volver</a></p>
{% endblock %}
